FROM docker.io/library/golang:alpine AS build
ARG TARGETOS TARGETARCH
ENV GOOS="$TARGETOS" GOARCH="$TARGETARCH" GOFLAGS="-buildvcs=false -trimpath" CGO_ENABLED=0
COPY CVE-2018-1212.go .
RUN go build -o /CVE-2018-1212 -ldflags "-w -s -buildid=" CVE-2018-1212.go

FROM scratch
COPY --from=build /CVE-2018-1212 /CVE-2018-1212
ENTRYPOINT [ "/CVE-2018-1212" ]
