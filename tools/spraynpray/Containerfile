FROM docker.io/library/golang:alpine AS build
ARG TARGETOS TARGETARCH
ENV GOOS="$TARGETOS" GOARCH="$TARGETARCH" GOFLAGS="-buildvcs=false -trimpath" CGO_ENABLED=0
COPY spraynpray.go .
RUN go build -o /spraynpray -ldflags "-w -s -buildid=" spraynpray.go

FROM scratch
COPY --from=build /spraynpray /spraynpray
ENTRYPOINT [ "/spraynpray" ]
