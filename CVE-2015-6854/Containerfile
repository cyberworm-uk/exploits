FROM docker.io/library/golang:alpine AS build
ARG TARGETOS TARGETARCH
ENV GOOS="$TARGETOS" GOARCH="$TARGETARCH" GOFLAGS="-buildvcs=false -trimpath" CGO_ENABLED=0
COPY CVE-2015-6854.go .
RUN go build -o /CVE-2015-6854 -ldflags "-w -s -buildid=" CVE-2015-6854.go

FROM scratch
COPY --from=build /CVE-2015-6854 /CVE-2015-6854
ENTRYPOINT [ "/CVE-2015-6854" ]
